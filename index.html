<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a responsive email layout.">
    <title>Email &ndash; Layout Examples &ndash; Pure</title>
    
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-" crossorigin="anonymous">
    
    
    
        <!--[if lte IE 8]>
            <link rel="stylesheet" href="css/layouts/email-old-ie.css">
        <![endif]-->
        <!--[if gt IE 8]><!-->
            <link rel="stylesheet" href="css/layouts/email.css">
        <!--<![endif]-->
</head>
<body>






<div id="layout" class="content pure-g">
    <div id="nav" class="pure-u">
        <a href="#" class="nav-menu-button">Menu</a>

        <div class="nav-inner">
            <button class="primary-button pure-button">Compose</button>

            <div class="pure-menu">
                <ul class="pure-menu-list">
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Inbox <span class="email-count">(2)</span></a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Important</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Sent</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Drafts</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link">Trash</a></li>
                    <li class="pure-menu-heading">Labels</li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link"><span class="email-label-personal"></span>Personal</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link"><span class="email-label-work"></span>Work</a></li>
                    <li class="pure-menu-item"><a href="#" class="pure-menu-link"><span class="email-label-travel"></span>Travel</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div id="list" class="pure-u-1">
        <div class="email-item email-item-selected pure-g">
            <div class="pure-u">
                <img width="64" height="64" alt="Tilo Mitra&#x27;s avatar" class="email-avatar" src="img/common/tilo-avatar.png">
            </div>

            <div class="pure-u-3-4">
                <h5 class="email-name">Tilo Mitra</h5>
                <h4 class="email-subject">Hello from Toronto</h4>
                <p class="email-desc">
                    Hey, I just wanted to check in with you from Toronto. I got here earlier today.
                </p>
            </div>
        </div>

        <div class="email-item email-item-unread pure-g">
            <div class="pure-u">
                <img width="64" height="64" alt="Eric Ferraiuolo&#x27;s avatar" class="email-avatar" src="img/common/ericf-avatar.png">
            </div>

            <div class="pure-u-3-4">
                <h5 class="email-name">Eric Ferraiuolo</h5>
                <h4 class="email-subject">Re: Pull Requests</h4>
                <p class="email-desc">
                    Hey, I had some feedback for pull request #51. We should center the menu so it looks better on mobile.
                </p>
            </div>
        </div>

    </div>

    <div id="main" class="pure-u-1">
        <div class="email-content">
            <div class="email-content-header pure-g">
                <div class="pure-u-1-2">
                    <h1 class="email-content-title">Hello from Toronto</h1>
                    <p class="email-content-subtitle">
                        From <a>Tilo Mitra</a> at <span>3:56pm, April 3, 2012</span>
                    </p>
                </div>

                <div class="email-content-controls pure-u-1-2">
                    <button class="secondary-button pure-button">Reply</button>
                    <button class="secondary-button pure-button">Forward</button>
                    <button class="secondary-button pure-button">Move to</button>
                </div>
            </div>

            <div class="email-content-body">
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                </p>
                <p>
                    Duis aute irure dolor in reprehenderit in voluptate velit essecillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                </p>
                <p>
                    Aliquam ac feugiat dolor. Proin mattis massa sit amet enim iaculis tincidunt. Mauris tempor mi vitae sem aliquet pharetra. Fusce in dui purus, nec malesuada mauris. Curabitur ornare arcu quis mi blandit laoreet. Vivamus imperdiet fermentum mauris, ac posuere urna tempor at. Duis pellentesque justo ac sapien aliquet egestas. Morbi enim mi, porta eget ullamcorper at, pharetra id lorem.
                </p>
                <p>
                    Donec sagittis dolor ut quam pharetra pretium varius in nibh. Suspendisse potenti. Donec imperdiet, velit vel adipiscing bibendum, leo eros tristique augue, eu rutrum lacus sapien vel quam. Nam orci arcu, luctus quis vestibulum ut, ullamcorper ut enim. Morbi semper erat quis orci aliquet condimentum. Nam interdum mauris sed massa dignissim rhoncus.
                </p>
                <p>
                    Regards,<br>
                    Tilo
                </p>
            </div>
        </div>
    </div>
</div>

<script src="https://yui-s.yahooapis.com/3.18.1/build/yui/yui-min.js"></script>
<script>
// create a function that returns all the email selectors in the DOM e.g., avatar, name, subject, etc.
captureEmailSelectors = () => {
  return {
    avatars: Array.from( document.querySelectorAll('.email-avatar') ),
    names: Array.from( document.querySelectorAll('.email-name') ),
    subjects: Array.from( document.querySelectorAll('.email-subject') ),
    descrips: Array.from( document.querySelectorAll('.email-desc') )                
  }
};

// dynamically replace each selector to the new values from the fetched emails array
replaceEmailValues(emailSelectors, emails ) = () => {
  emailSelectors.avatars.map( (avatar, index) => avatar.src = emails[index].image );
  emailSelectors.names.map( (name, index) => name.textContent = emails[index].name );
  emailSelectors.subjects.map( (subject, index) => subject.textContent = emails[index].subject );
  emailSelectors.descrips.map( (descrip, index) => descrip.textContent = emails[index].desc );               
  }; 


fetch('https://my.api.mockaroo.com/emails.json?key=7251a1d0')
        .then(response => response.json())
        .then(emails => {
          // call the functions that capture the email selectors and replaces them w/ new API values 
          replaceEmailValues(captureEmailSelectors(), emails);
          
          // GOAL: create a new '.email-item' div element to the inbox area on click of compose. 

          // first, create counter to keep track of additional emails added to inbox, starting at an index of 2
          let counter = 2;

          // first create a div snippet that represents an email
          let snippet = `
            <div class="email-item email-item-unread pure-g">
            <div class="pure-u">
            <img width="64" height="64" alt="${emails[counter].name}'s avatar" class="email-avatar" src="${emails[counter].image}">
            </div>

            <div class="pure-u-3-4">
            <h5 class="email-name">${emails[counter].name}</h5>
            <h4 class="email-subject">${emails[counter].subject}</h4>
            <p class="email-desc">
            ${emails[counter].desc}
            </p>
            </div>
            </div>`;

          // target the compse button
          const compose = document.querySelector('.primary-button');

          // target the area of the dom to add snippet i.e., #list
          const inbox = document.querySelector('#list');

          // set an 'if' statement to add snippet to dom upon click if the selectors are less than 2 
          compose.addEventListener('click', () => {
            if(captureEmailSelectors().avatars.length >= 2 && captureEmailSelectors().avatars.length < 7) {
              // insert the dummy snippet to the inbox 
              inbox.insertAdjacentHTML('beforeend', snippet);

              // re-capture the selectors in newly added DOM and re-run the map method to replace DOM values
              replaceEmailValues(captureEmailSelectors(), emails);
              console.log(captureEmailSelectors().avatars.length); 
              counter++;  

            }
            else console.log("no more emails to add");
          });

        });


</script>




</body>
</html>
